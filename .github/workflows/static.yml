name: Generate Site
run-name: ${{ github.actor }} is generating Site ðŸš€ 
on: 
  push:
    branches:
      - master
  workflow_dispatch: # Allows triggering the build manually

permissions:
  # This permission governs access to the repository's code and files.
  contents: read 
  # This permission is used for OpenID Connect (OIDC) authentication. id-token: write: Allows the workflow to generate a JSON Web Token (JWT) that can be used to authenticate with external cloud providers (like AWS, Azure, or GCP) or other services that support OIDC. This enables secure, passwordless authentication from GitHub Actions to external systems.
  id-token: write 

# Concurrency in GitHub Actions allows you to control the simultaneous execution of workflow runs or jobs.
concurrency:
  group: 'website'
  cancel-in-progress: true 

jobs:
  Generate-Website:
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository code
        uses: actions/checkout@v5
        with:
          ref: master
      - name: Checkout private repository
        uses: actions/checkout@v5
        with:
          repository: ${{ secrets.OTHER_REPO }}
          token: ${{ secrets.ACCESS_PRI_REPO }}
          ref: main
          path: ./other-repo
      - name: Move files into one dir
        run: |
          mv ./other-repo/* ./
      - name: List all files are double clone
        run: | 
          tree 
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: yarn
      - run: yarn
      - run: yarn build
